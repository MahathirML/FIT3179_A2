<!DOCTYPE html>
<html>
<head>
  <!-- Import Vega & Vega-Lite -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
  
  <!-- CSS file for styles -->
  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">
</head>

<header>
  <!-- Big Title Section -->
  <h1>Victorian Train Stations Analysis</h1>
  <p class="caption">
    This visualization allows users to interactively explore the spatial distribution and usage of train stations in Victoria. comparing regional and metropolitan areas, while also highlighting key performance metrics and accessibility features that impact public transport users.
  </p>
</header>

  <body>
  <!-- Section Title -->
  <section id="regional-metropolitan-stations">
    <h2>Regional and Metropolitan Stations</h2>
    <div id="visualization-container">
      <div class="visualization-block map-block" style="padding-bottom: 10px;">
        <div class="text map-text" style="padding-bottom: 10px;">
          <h3>Passenger Activity Across Train Stations in Victoria</h3>
          <p>There are 222 train stations across Victoria as shown by this map. You can select a region below to view the stations in that area</p>
          <p>Explore the geographic distribution and passenger activities of the region in the next section.</p>
          
          <!-- Enhanced Map Visualization Block -->
          <div style="margin-bottom: 5px;">
            <label for="region-select" style="font-weight: bold;">Select a Region:</label>
          </div>
          <div>
            <select id="region-select" style="padding: 8px; border-radius: 5px; border: 1px solid #ccc; background-color: #f5f5f5; font-size: 14px;">
              <option value="All">All Regions</option>
              <option value="Ballarat">Ballarat</option>
              <option value="Bendigo">Bendigo</option>
              <option value="Geelong">Geelong</option>
              <option value="Hume">Hume</option>
              <option value="Latrobe - Gippsland">Latrobe - Gippsland</option>
              <option value="Melbourne - Inner">Melbourne - Inner</option>
              <option value="Melbourne - Inner East">Melbourne - Inner East</option>
              <option value="Melbourne - Inner South">Melbourne - Inner South</option>
              <option value="Melbourne - North East">Melbourne - North East</option>
              <option value="Melbourne - North West">Melbourne - North West</option>
              <option value="Melbourne - Outer East">Melbourne - Outer East</option>
              <option value="Melbourne - South East">Melbourne - South East</option>
              <option value="Melbourne - West">Melbourne - West</option>
              <option value="Mornington Peninsula">Mornington Peninsula</option>
              <option value="North West">North West</option>
              <option value="Shepparton">Shepparton</option>
              <option value="Warrnambool and South West">Warrnambool and South West</option>
            </select>
          </div>
        </div>
        
        <!-- Visualization Block -->
        <div id="symbol_map" class="map-symbol"></div>
      </div>
      
      
      <!-- Pie Chart, Text, and Bar Chart in the same line -->
      <div class="visualization-block combined-block">
        <div class="visualization-item">
          <div id="pie_chart"></div>
          <div class="text">
            <h3>Regional vs Metropolitan Stations in Melbourne</h3>
            <p style="font-style: italic;">The pie chart highlights the distribution of regional and metropolitan train stations in the selected region.</p>
          </div>
        </div>

        <div class="middle-text">
          <p>
            Regional stations cater to the majority of the population outside Melbourne, while metropolitan stations handle the bulk of the city's daily commuters.
            <br><br>
            We can see that some regional stations have much higher patronage counts than others, generally due to them being central hubs. Similarly, some end-of-the-line stations experience high passenger volumes. For example, Glen Waverley Station has a notably high count, and interchanges like Richmond are very popular.
            <br><br>
            Flinders Street Station sees over <span style="color: #E3A187;"><strong>20 million</strong></span> passengers annually, making it the most used station in Melbourne.
            <br><br>
            Of course, the City Loop remains the most popular, as Melbourne City is the heart of Victoria's transport system.
          </p>
          
        </div>

        <div class="visualization-item">
          <div id="bar_chart"></div>
          <div class="text">
            <h3>Most Used Stations in Melbourne</h3>
            <p style="font-style: italic;">The bar chart shows the most used train stations in the selected region.</p>
          </div>
        </div>
      </div>

      

    <!-- New 3 Bar Charts Side by Side -->
    <section id="station-facilities">
      <h2>Station Accessibilty Facilities</h2>
      <!-- New 3-item Block for Highlights -->
      <div class="visualization-block highlight-block">
        <div class="highlight-item">
          <p class="highlight-percentage">69%</p>
          <p class="highlight-text">of residences meet this target</p>
        </div>
        <div class="highlight-item middle-text">
          <p>The Victorian Planning Provisions require <strong style="color: #E3A187;">95%</strong> of Melbourne residences to be within 400 m walking distance of a bus stop, 600 m of a tram stop, or 800 m of a train station. <strong style="color: #E3A187;">How accessible are these stations, though?</strong></p>
        </div>
        
        <div class="highlight-item">
          <p class="highlight-percentage">14%</p>
          <p class="highlight-text">of suburbs meet this target.</p>
        </div>
      </div>

      <!-- Three bar charts side by side -->
      <div class="visualization-block combined-block">
        <div class="visualization-item visualization-item-third">
          <div id="lift_chart"></div>
          <div class="text">
            <h3>Lifts Availability</h3>
            <p style="font-style: italic;">This bar chart shows the availability of lifts across train stations in Melbourne.</p>
          </div>
        </div>

        <div class="visualization-item visualization-item-third">
          <div id="hearing_aid_chart"></div>
          <div class="text">
            <h3>Hearing Loop Availability</h3>
            <p style="font-style: italic;">This bar chart shows the availability of hearing loops at train stations, which support hearing aid users.</p>
          </div>
        </div>

        <div class="visualization-item visualization-item-third">
          <div id="pids_chart"></div>
          <div class="text">
            <h3>Passenger Information Display Systems Availability</h3>
            <p style="font-style: italic;">This bar chart categorizes the types of Passenger Information Display Systems (PIDS) across the stations.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Three Item Block (Delivery Chart, Text, Punctuality Chart) -->
<section id="performance-metrics">
  <h2>Performance Metrics: Delivery and Punctuality</h2>

  <div class="visualization-block combined-block">
    <!-- Delivery Chart -->
    <div class="visualization-item">
      <div id="delivery_chart"></div>
      <div class="text">
        <h3>Delivery Performance Over Time</h3>
        <p style="font-style: italic;">This chart shows delivery performance trends over time.</p>
      </div>
    </div>

    <!-- Middle Text Section -->
    <div class="middle-text">
      <p>
        Metro spends <span style="color: #E3A187;"><strong>$12 million</strong></span> per week on public transport, so we deserve nothing less than top-tier performance.
        <br><br>
        Delivery and punctuality metrics are critical indicators of service quality. Monitoring trends over time helps to maintain and improve standards. 
        <br><br>
        <strong>Key Takeaways:</strong>
        <br>
        1. Significant improvements in punctuality during peak times like COVID lockdowns.
        <br>
        2. Notable dips during periods of operational adjustment, such as post-lockdown recovery.
      </p>
    </div>

    <!-- Punctuality Diverging Bar Chart -->
    <div class="visualization-item">
      <div id="punctuality_chart"></div>
      <div class="text">
        <h3>Punctuality Divergence Over Time</h3>
        <p style="font-style: italic;">This chart visualizes how punctuality performance deviates from the target over time.</p>
      </div>
    </div>
  </div>
</section>

  </div>
</section>

  <!-- Embed the visualizations -->
  <script type="text/javascript">
    // Function to update visualizations with the selected region
    function updateVisualizations(region) {
      var mapSpec = "js/ps_map.vg.json";
      vegaEmbed('#symbol_map', mapSpec, { actions: false, renderer: 'svg' })
        .then(function(result) {
          result.view.signal('selectedRegion', region).run();
        }).catch(console.error);
  
      var pieSpec = "js/pie_chart.vg.json";
      vegaEmbed('#pie_chart', pieSpec, { actions: false, renderer: 'svg' })
        .then(function(result) {
          result.view.signal('selectedRegion', region).run();
        }).catch(console.error);

      var barSpec = "js/bar_chart.vg.json";
      vegaEmbed('#bar_chart', barSpec, { actions: false, renderer: 'svg' })
        .then(function(result) {
          result.view.signal('selectedRegion', region).run();
        }).catch(console.error);
    }
  
    updateVisualizations('All');
  
    const regionSelect = document.getElementById('region-select');
    regionSelect.addEventListener('change', function() {
      updateVisualizations(regionSelect.value);
    });
  
    // Lift Chart
var liftChartSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {"url": "https://raw.githubusercontent.com/MahathirML/FIT3179_A2/refs/heads/main/data/accessibility_data.csv"},
  "mark": "bar",
  "encoding": {
    "y": {"aggregate": "count", "field": "station", "type": "quantitative", "title": "Number of Stations"},
    "color": {
      "field": "lift", 
      "type": "nominal",
      "scale": {"range": ["#E3A187", "#9BC5DD", "#f7c6c7"]}  // Custom color scheme
    },
    "tooltip": [
      {"field": "lift", "title": "Lift Availability"},
      {"aggregate": "count", "field": "station", "title": "Number of Stations"}
    ]
  }
};
vegaEmbed('#lift_chart', liftChartSpec, { actions: false }).catch(console.error);

// Hearing Aid Chart
var hearingAidChartSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {"url": "https://raw.githubusercontent.com/MahathirML/FIT3179_A2/refs/heads/main/data/accessibility_data.csv"},
  "mark": "bar",
  "encoding": {
    "y": {"aggregate": "count", "field": "station", "type": "quantitative", "title": "Number of Stations"},
    "color": {
      "field": "he_loop", 
      "type": "nominal",
      "scale": {"range": ["#E3A187", "#9BC5DD", "#f7c6c7"]}  // Custom color scheme
    },
    "tooltip": [
      {"field": "he_loop", "title": "Hearing Loop Availability"},
      {"aggregate": "count", "field": "station", "title": "Number of Stations"}
    ]
  }
};
vegaEmbed('#hearing_aid_chart', hearingAidChartSpec, { actions: false }).catch(console.error);

// PIDS Chart
var pidsChartSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {"url": "https://raw.githubusercontent.com/MahathirML/FIT3179_A2/refs/heads/main/data/accessibility_data.csv"},
  "mark": {
    "type": "bar",
    "cornerRadiusEnd": 2,  // Rounds the corners of the bars
    "width": {"band": 0.8} // Adjusts the width of the bars to add space
  },
  "encoding": {
    "x": {"field": "pids", "type": "nominal", "title": "PIDS Type"},
    "y": {"aggregate": "count", "field": "station", "type": "quantitative", "title": "Number of Stations"},
    "color": {
      "field": "pids", 
      "type": "nominal",
      "scale": {"range": ["#E3A187", "#9BC5DD", "#f7c6c7"]},
      "legend": null  // Removes the legend
    },
    "tooltip": [
      {"field": "pids", "title": "PIDS Type"},
      {"aggregate": "count", "field": "station", "title": "Number of Stations"}
    ]
  }
};
vegaEmbed('#pids_chart', pidsChartSpec, { actions: false }).catch(console.error);

    vegaEmbed('#delivery_chart', 'js/delivery_chart.vg.json', { actions: false }).catch(console.error);

    vegaEmbed('#punctuality_chart', 'js/punctuality_chart.vg.json', { actions: false }).catch(console.error);
  </script>
</body>
</html>
